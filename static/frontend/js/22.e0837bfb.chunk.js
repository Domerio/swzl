"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[22],{655:function(t,e,a){var r=a(6955),s=String;t.exports=function(t){if("Symbol"===r(t))throw new TypeError("Cannot convert a Symbol value to a string");return s(t)}},713:function(t,e,a){var r=a(9565),s=a(9306),i=a(8551),n=a(1767),o=a(9462),l=a(6319),c=o((function(){var t=this.iterator,e=i(r(this.next,t)),a=this.done=!!e.done;if(!a)return l(t,this.mapper,[e.value,this.counter++],!0)}));t.exports=function(t){return i(this),s(t),new c(n(this),{mapper:t})}},1701:function(t,e,a){var r=a(6518),s=a(713),i=a(6395);r({target:"Iterator",proto:!0,real:!0,forced:i},{map:s})},2489:function(t,e,a){var r=a(6518),s=a(9565),i=a(9306),n=a(8551),o=a(1767),l=a(9462),c=a(6319),d=a(6395),u=l((function(){var t,e,a,r=this.iterator,i=this.predicate,o=this.next;while(1){if(t=n(s(o,r)),e=this.done=!!t.done,e)return;if(a=t.value,c(r,i,[a,this.counter++],!0))return a}}));r({target:"Iterator",proto:!0,real:!0,forced:d},{filter:function(t){return n(this),i(t),new u(o(this),{predicate:t})}})},2529:function(t){t.exports=function(t,e){return{value:t,done:e}}},2812:function(t){var e=TypeError;t.exports=function(t,a){if(t<a)throw new e("Not enough arguments");return t}},4603:function(t,e,a){var r=a(6840),s=a(9504),i=a(655),n=a(2812),o=URLSearchParams,l=o.prototype,c=s(l.append),d=s(l["delete"]),u=s(l.forEach),p=s([].push),m=new o("a=1&a=2&b=3");m["delete"]("a",1),m["delete"]("b",void 0),m+""!=="a=2"&&r(l,"delete",(function(t){var e=arguments.length,a=e<2?void 0:arguments[1];if(e&&void 0===a)return d(this,t);var r=[];u(this,(function(t,e){p(r,{key:e,value:t})})),n(e,1);var s,o=i(t),l=i(a),m=0,h=0,g=!1,v=r.length;while(m<v)s=r[m++],g||s.key===o?(g=!0,d(this,s.key)):h++;while(h<v)s=r[h++],s.key===o&&s.value===l||c(this,s.key,s.value)}),{enumerable:!0,unsafe:!0})},6279:function(t,e,a){var r=a(6840);t.exports=function(t,e,a){for(var s in e)r(t,s,e[s],a);return t}},6319:function(t,e,a){var r=a(8551),s=a(9539);t.exports=function(t,e,a,i){try{return i?e(r(a)[0],a[1]):e(a)}catch(n){s(t,"throw",n)}}},7022:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"admin-dashboard"},[e("div",{staticClass:"dashboard-header"},[e("div",{staticClass:"header-content"},[e("div",[e("h1",{staticClass:"welcome-title"},[t._v("Ê¨¢ËøéÂõûÊù•Ôºå"+t._s(t.user.real_name)+"ÔºÅüëã")])]),e("div",{staticClass:"button-group"},[e("el-button",{staticClass:"report-btn",attrs:{type:"primary",plain:"",icon:"el-icon-document"},on:{click:function(e){t.reportDialogVisible=!0}}},[t._v(" ÁîüÊàêÊä•Ë°® ")]),e("el-button",{staticClass:"logout-btn",attrs:{type:"danger",plain:"",icon:"el-icon-switch-button"},on:{click:t.handleLogout}},[t._v(" ÈÄÄÂá∫ÁôªÂΩï ")])],1)]),e("p",{staticClass:"welcome-sub"},[t._v("‰ªäÊó•Êúâ "+t._s(t.pendingCount)+" È°πÂæÖÂ§ÑÁêÜ‰∫ãÂä°")])]),e("el-row",{staticClass:"metric-grid",attrs:{gutter:24}},[e("el-col",{attrs:{xs:24,sm:12,lg:8}},[e("el-card",{staticClass:"metric-card metric-pending",attrs:{shadow:"hover"}},[e("div",{staticClass:"metric-content"},[e("div",{staticClass:"metric-icon"},[e("i",{staticClass:"el-icon-time"})]),e("div",{staticClass:"metric-info"},[e("span",{staticClass:"metric-label"},[t._v("ÂæÖÂÆ°Ê†∏")]),e("span",{staticClass:"metric-value"},[t._v(t._s(t.pendingCount))])])])])],1),e("el-col",{attrs:{xs:24,sm:12,lg:8}},[e("el-card",{staticClass:"metric-card metric-active",attrs:{shadow:"hover"}},[e("div",{staticClass:"metric-content"},[e("div",{staticClass:"metric-icon"},[e("i",{staticClass:"el-icon-loading"})]),e("div",{staticClass:"metric-info"},[e("span",{staticClass:"metric-label"},[t._v("ËøõË°å‰∏≠")]),e("span",{staticClass:"metric-value"},[t._v(t._s(t.activeCount))])])])])],1),e("el-col",{attrs:{xs:24,sm:12,lg:8}},[e("el-card",{staticClass:"metric-card metric-completed",attrs:{shadow:"hover"}},[e("div",{staticClass:"metric-content"},[e("div",{staticClass:"metric-icon"},[e("i",{staticClass:"el-icon-success"})]),e("div",{staticClass:"metric-info"},[e("span",{staticClass:"metric-label"},[t._v("Â∑≤ÂÆåÊàê")]),e("span",{staticClass:"metric-value"},[t._v(t._s(t.completedCount))])])])])],1)],1),e("el-row",{staticClass:"data-grid",attrs:{gutter:24}},[e("el-col",{attrs:{xs:24,lg:12}},[e("el-card",{staticClass:"data-card",attrs:{shadow:"never"},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"card-header"},[e("div",{staticClass:"header-title"},[e("i",{staticClass:"el-icon-box"}),e("span",[t._v("ÊúÄÊñ∞Â§±Áâ©‰ø°ÊÅØ")])]),e("el-button",{staticClass:"view-more",attrs:{type:"text"}})],1)]},proxy:!0}])},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.posts,expression:"loading.posts"}],staticClass:"data-table",attrs:{data:t.recentPosts,"empty-text":"ÊöÇÊó†ÂæÖÂ§ÑÁêÜ‰ø°ÊÅØ","header-cell-style":{background:"#f8f9fa"},height:"330"},on:{"row-click":t.handleRowClick},scopedSlots:t._u([{key:"empty",fn:function(){return[e("div",{staticClass:"empty-state"},[e("i",{staticClass:"el-icon-document-remove"}),e("span",[t._v("ÂΩìÂâçÊ≤°ÊúâÂèØÊòæÁ§∫ÁöÑÂ§±Áâ©‰ø°ÊÅØ")])])]},proxy:!0}])},[e("el-table-column",{attrs:{prop:"title",label:"Áâ©ÂìÅÂêçÁß∞","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("span",{staticClass:"text-ellipsis"},[t._v(t._s(a.title))])]}}])}),e("el-table-column",{attrs:{label:"Á±ªÂûã",width:"100"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(" "+t._s(t.getItemTypeLabel(e.item_type))+" ")]}}])}),e("el-table-column",{attrs:{prop:"category",label:"ÂàÜÁ±ª",width:"120"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("el-tag",{attrs:{effect:"plain"}},[t._v(t._s(a.category))])]}}])}),e("el-table-column",{attrs:{label:"Áä∂ÊÄÅ",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("el-tag",{staticClass:"status-tag",attrs:{type:t.statusTypeMap[a.status],effect:"light"}},[t._v(" "+t._s(a.status)+" ")])]}}])})],1)],1)],1),e("el-col",{attrs:{xs:24,lg:12}},[e("el-card",{staticClass:"data-card",attrs:{shadow:"never"},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"card-header"},[e("div",{staticClass:"header-title"},[e("i",{staticClass:"el-icon-user"}),e("span",[t._v("Êñ∞Â¢ûÁî®Êà∑")])]),e("el-button",{staticClass:"view-more",attrs:{type:"text"}})],1)]},proxy:!0}])},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.users,expression:"loading.users"}],staticClass:"data-table",attrs:{data:t.recentUsers,"header-cell-style":{background:"#f8f9fa"},height:"330"},on:{"row-click":t.handleUserRowClick}},[e("el-table-column",{attrs:{prop:"username",label:"Â≠¶Â∑•Âè∑","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("div",{staticClass:"user-cell"},[e("el-avatar",{attrs:{size:24,src:a.avatar||t.defaultAvatar}},[t._v(" "+t._s(a.real_name?.charAt(0)||"?")+" ")]),e("span",[t._v(t._s(a.username||"Êó†Êï∞ÊçÆ"))])],1)]}}])}),e("el-table-column",{attrs:{prop:"real_name",label:"ÂßìÂêç",width:"100"}}),e("el-table-column",{attrs:{prop:"role",label:"ËßíËâ≤",width:"100"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("el-tag",{staticClass:"role-tag",attrs:{type:t.roleTagType(a.role),effect:"light"}},[t._v(" "+t._s(a.role)+" ")])]}}])})],1)],1)],1)],1),e("el-dialog",{staticClass:"admin-detail-dialog",attrs:{title:"üì¶ Áâ©ÂìÅËØ¶ÊÉÖ",visible:t.itemDialogVisible,width:"800px"},on:{"update:visible":function(e){t.itemDialogVisible=e}}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:8}},[e("el-carousel",{attrs:{interval:5e3,height:"300px",arrow:"always"}},t._l(t.currentItem.images,(function(a,r){return e("el-carousel-item",{key:r},[e("el-image",{staticClass:"detail-image",attrs:{src:a,"preview-src-list":t.currentItem.images,fit:"cover"}},[e("div",{staticClass:"image-error",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])])],1)})),1)],1),e("el-col",{attrs:{span:16}},[e("el-descriptions",{attrs:{column:2,border:"","label-class-name":"detail-label"}},[e("el-descriptions-item",{attrs:{label:"Áâ©ÂìÅÂêçÁß∞"}},[t._v(t._s(t.currentItem.title))]),e("el-descriptions-item",{attrs:{label:"ÂàÜÁ±ª"}},[t._v(t._s(t.currentItem.category))]),e("el-descriptions-item",{attrs:{label:"ÂèëÂ∏ÉÁ±ªÂûã"}},[t._v(" "+t._s("lost"===t.currentItem.item_type?"Â§±Áâ©ÁôªËÆ∞":"ÊãõÈ¢ÜÁôªËÆ∞")+" ")]),e("el-descriptions-item",{attrs:{label:"‰∏¢Â§±Êó∂Èó¥"}},[t._v(t._s(t.formatTime(t.currentItem.lost_time)))]),e("el-descriptions-item",{attrs:{label:"‰∏¢Â§±Âú∞ÁÇπ"}},[t._v(" "+t._s(t.currentItem.location)+" "),t.currentItem.location_lat&&t.currentItem.location_lng?e("div",{staticClass:"detail-map-container",attrs:{id:"detail-map-"+t.currentItem.id}}):t._e()]),e("el-descriptions-item",{attrs:{label:"Êèê‰∫§‰∫∫"}},["admin"===t.currentItem.user?.role?e("el-tooltip",{attrs:{content:"ÁÆ°ÁêÜÂëòË¥¶Âè∑"}},[e("i",{staticClass:"el-icon-s-custom"})]):t._e(),t._v(" "+t._s(t.currentItem.user?.real_name||"ÂåøÂêçÁî®Êà∑")+" "),t.currentItem.user?e("span",{staticClass:"user-role-tag"},[t._v(" ("+t._s(t.roleMap[t.currentItem.user.role])+") ")]):t._e()],1),e("el-descriptions-item",{attrs:{label:"Áä∂ÊÄÅ"}},[e("el-tag",{attrs:{type:t.statusTypeMap[t.currentItem.status]}},[t._v(t._s(t.currentItem.status))])],1),e("el-descriptions-item",{attrs:{label:"ËÅîÁ≥ªÊñπÂºè",span:2}},[e("el-link",{attrs:{type:"primary"}},[t._v(t._s(t.currentItem.contact))])],1),e("el-descriptions-item",{attrs:{label:"ËØ¶ÁªÜÊèèËø∞",span:2}},[e("pre",{staticClass:"description-pre"},[t._v(t._s(t.currentItem.description))])])],1)],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.itemDialogVisible=!1}}},[t._v("ÂÖ≥Èó≠")]),"pending"===t.currentItem.status?e("el-button",{attrs:{type:"success",disabled:!t.currentItem.id||t.approvalProcessing,loading:t.approvalProcessing},on:{click:t.handleApproveItem}},[t._v(" "+t._s(t.approvalProcessing?"Ê≠£Âú®Â§ÑÁêÜ...":"ÂÆ°Ê†∏ÈÄöËøá")+" ")]):t._e(),e("el-button",{attrs:{type:"danger",disabled:!t.currentItem.id||t.deletionProcessing,loading:t.deletionProcessing},on:{click:t.handleDeleteItem}},[t._v(" "+t._s(t.deletionProcessing?"Ê≠£Âú®Âà†Èô§...":"Âà†Èô§Áâ©ÂìÅ")+" ")])],1)],1),e("el-dialog",{staticClass:"admin-detail-dialog",attrs:{title:"üë§ Áî®Êà∑ËØ¶ÊÉÖ",visible:t.userDialogVisible,width:"600px"},on:{"update:visible":function(e){t.userDialogVisible=e}}},[e("el-descriptions",{attrs:{column:2,border:""}},[e("el-descriptions-item",{attrs:{label:"Áî®Êà∑ID"}},[t._v(t._s(t.currentUser.id))]),e("el-descriptions-item",{attrs:{label:"Áî®Êà∑Âêç"}},[t._v(t._s(t.currentUser.username))]),e("el-descriptions-item",{attrs:{label:"ÁúüÂÆûÂßìÂêç"}},[t._v(t._s(t.currentUser.real_name))]),e("el-descriptions-item",{attrs:{label:"Áî®Êà∑ËßíËâ≤"}},[e("el-tag",{attrs:{type:t.roleTagType(t.currentUser.role)}},[t._v(t._s(t.currentUser.role))])],1),e("el-descriptions-item",{attrs:{label:"Ê≥®ÂÜåÊó∂Èó¥"}},[t._v(t._s(t.currentUser.date_joined))]),e("el-descriptions-item",{attrs:{label:"ËÅîÁ≥ªÊñπÂºè"}},[t._v(t._s(t.currentUser.phone))]),e("el-descriptions-item",{attrs:{label:"ÁîµÂ≠êÈÇÆÁÆ±"}},[t._v(t._s(t.currentUser.email))])],1)],1),e("el-dialog",{attrs:{title:"üìä ÁîüÊàêÁ≥ªÁªüÊä•Ë°®",visible:t.reportDialogVisible,width:"500px"},on:{"update:visible":function(e){t.reportDialogVisible=e}}},[e("el-form",{attrs:{model:t.reportForm,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"Êä•Ë°®Á±ªÂûã"}},[e("el-select",{attrs:{placeholder:"ËØ∑ÈÄâÊã©Êä•Ë°®Á±ªÂûã"},model:{value:t.selectedReportType,callback:function(e){t.selectedReportType=e},expression:"selectedReportType"}},[e("el-option",{attrs:{label:"ÊúàÂ∫¶ÁªüËÆ°Êä•Ë°®",value:"monthly"}}),e("el-option",{attrs:{label:"ÂàÜÁ±ªÁªüËÆ°Êä•Ë°®",value:"category"}}),e("el-option",{attrs:{label:"Áî®Êà∑Ê¥ªË∑ÉÂ∫¶Êä•Ë°®",value:"user_activity"}})],1)],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.reportDialogVisible=!1}}},[t._v("ÂèñÊ∂à")]),e("el-button",{attrs:{type:"primary",loading:t.reportLoading},on:{click:t.generateReport}},[t._v(" "+t._s(t.reportLoading?"ÁîüÊàê‰∏≠...":"Á°ÆËÆ§ÁîüÊàê")+" ")])],1)],1)],1)},s=[],i=(a(8111),a(2489),a(7588),a(1701),a(4603),a(7566),a(8721),a(4335)),n=a(4353),o=a.n(n),l={data(){return{user:{real_name:"Âä†ËΩΩ‰∏≠...",avatar:a(7799),role:"",phone:""},defaultAvatar:a(7799),pendingCount:0,activeCount:0,completedCount:0,recentPosts:[],recentUsers:[],loading:{posts:!0,users:!0},statusTypeMap:{pending:"warning",active:"primary",completed:"success",expired:"info"},itemDialogVisible:!1,userDialogVisible:!1,currentItem:{},currentUser:{},deletionProcessing:!1,reportDialogVisible:!1,selectedReportType:"monthly",reportLoading:!1}},computed:{roleMap(){return{admin:"ÁÆ°ÁêÜÂëò",teacher:"ÊïôËÅåÂ∑•",student:"Â≠¶Áîü"}}},mounted(){if(this.fetchAdminData(),this.$nextTick((()=>{const t=new MutationObserver((()=>{const t=document.querySelectorAll(".el-loading-mask");t.forEach((t=>{"none"!==t.style.display&&setTimeout((()=>t.style.display="none"),5e3)}))}));t.observe(this.$el,{childList:!0,subtree:!0})})),!window.AMap){const t="db70318a1cf1f196b2746f10cb9df826",e=["AMap.Scale","AMap.ToolBar"].join(","),a=document.createElement("script");a.src=`https://webapi.amap.com/maps?v=2.0&key=${t}&plugin=${e}`,a.onerror=()=>{console.error("È´òÂæ∑Âú∞ÂõæSDKÂä†ËΩΩÂ§±Ë¥•")},document.head.appendChild(a)}},methods:{async generateReport(){if(this.selectedReportType)try{this.reportLoading=!0;const t=await i.A.get(`/api/admin/reports/?type=${this.selectedReportType}`,{responseType:"blob",headers:{Authorization:`Token ${localStorage.getItem("token")}`}}),e=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=e,a.setAttribute("download",`${this.selectedReportType}_report_${(new Date).toISOString().slice(0,10)}.xlsx`),document.body.appendChild(a),a.click(),this.reportDialogVisible=!1}catch(t){console.error("Êä•Ë°®ÁîüÊàêÂ§±Ë¥•:",t),this.$message.error("Êä•Ë°®ÁîüÊàêÂ§±Ë¥•")}finally{this.reportLoading=!1}else this.$message.warning("ËØ∑ÈÄâÊã©Êä•Ë°®Á±ªÂûã")},handleDeleteItem(){this.$confirm("Á°ÆÂÆöË¶ÅÂà†Èô§ËØ•Áâ©ÂìÅÂêóÔºü","ÊèêÁ§∫",{confirmButtonText:"Á°ÆÂÆö",cancelButtonText:"ÂèñÊ∂à",type:"warning"}).then((()=>{this.deletionProcessing=!0,i.A.delete(`/api/admin/items/${this.currentItem.id}/delete/`).then((()=>{this.deletionProcessing=!1,this.recentPosts=this.recentPosts.filter((t=>t.id!==this.currentItem.id)),this.itemDialogVisible=!1,this.$message.success("Áâ©ÂìÅÂà†Èô§ÊàêÂäü")})).catch((t=>{this.deletionProcessing=!1,this.$message.error("Áâ©ÂìÅÂà†Èô§Â§±Ë¥•Ôºö"+t.message)}))})).catch((()=>{this.$message.info("Âà†Èô§Êìç‰ΩúÂ∑≤ÂèñÊ∂à")}))},initDetailMap(){if(!window.AMap)return void this.$message.warning("Âú∞ÂõæËµÑÊ∫êÊ≠£Âú®Âä†ËΩΩÔºåËØ∑Á®çÂÄô");const t=parseFloat(this.currentItem.location_lng),e=parseFloat(this.currentItem.location_lat);isNaN(t)||isNaN(e)?console.warn("Êó†ÊïàÁöÑÁªèÁ∫¨Â∫¶Êï∞ÊçÆ",this.currentItem):this.$nextTick((()=>{try{this.destroyDetailMap();const a=`detail-map-${this.currentItem.id}`,r=document.getElementById(a);if(!r)return;this.detailMap=new AMap.Map(a,{zoom:17,center:new AMap.LngLat(t,e),resizeEnable:!0,viewMode:"3D"});const s=[new AMap.Scale,new AMap.ToolBar({position:{bottom:"20px",right:"20px"}})];s.forEach((t=>t.addTo(this.detailMap))),new AMap.Marker({position:new AMap.LngLat(t,e),content:'<div class="detail-marker">üìç</div>',map:this.detailMap})}catch(a){console.error("Âú∞ÂõæÂàùÂßãÂåñÂ§±Ë¥•:",a),this.$message.error("Âú∞ÂõæÂä†ËΩΩÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•")}}))},destroyDetailMap(){if(this.detailMap){try{this.detailMap.clearMap(),this.detailMap.destroy();const t=this.detailMap.getContainer();t&&t.parentNode&&t.parentNode.removeChild(t)}catch(t){console.warn("Âú∞ÂõæÈîÄÊØÅÂºÇÂ∏∏:",t.message)}this.detailMap=null}},getItemTypeLabel(t){return"lost"===t?"Â§±Áâ©":"ÊãõÈ¢Ü"},getCategoryName(t){return i.A.get(`/api/category/name/${t}/`).then((t=>t.data.name)).catch((()=>"Êú™Áü•ÂàÜÁ±ª"))},formatTime(t){return o()(t).format("YYYY-MM-DD HH:mm")},handleLogout(){this.$confirm("Á°ÆÂÆöË¶ÅÈÄÄÂá∫Á≥ªÁªüÂêóÔºü","Êìç‰ΩúÁ°ÆËÆ§",{type:"warning",confirmButtonText:"Á°ÆËÆ§ÈÄÄÂá∫",cancelButtonText:"ÂèñÊ∂à"}).then((()=>{this.$store.dispatch("logout"),this.$router.replace("/login"),this.$message.success("Â∑≤ÂÆâÂÖ®ÈÄÄÂá∫Á≥ªÁªü")})).catch((()=>{}))},roleTagType(t){const e={admin:"danger",teacher:"warning",student:"success"};return e[t]||"info"},async fetchAdminData(){try{this.loading={posts:!0,users:!0};const t={headers:{Authorization:`Token ${localStorage.getItem("token")}`}},[e,a,r,s]=await Promise.all([i.A.get("/api/user/profile/",t),i.A.get("/api/admin/stats/",t),i.A.get("/api/admin/recent-posts/",t),i.A.get("/api/admin/recent-users/",t)]);this.user=e.data,this.pendingCount=a.data.pending_count,this.activeCount=a.data.active_count,this.completedCount=a.data.completed_count,this.recentPosts=r.data.recent_posts,this.recentUsers=s.data.recent_users}catch(t){console.error("Error:",t),this.$message.error(t.response?.data?.message||"Êï∞ÊçÆÂä†ËΩΩÂ§±Ë¥•")}finally{this.loading={posts:!1,users:!1}}},async handleRowClick(t){try{const e=`/api/admin/found-items/${t.id}/`,a=await i.A.get(e,{headers:{Authorization:`Token ${localStorage.getItem("token")}`}}),r=await this.getCategoryName(a.data.category);this.currentItem={...a.data,category:r,images:a.data.images||[],user:a.data.user||{}},this.itemDialogVisible=!0}catch(e){this.$message.error("Ëé∑ÂèñËØ¶ÊÉÖÂ§±Ë¥•")}},async handleUserRowClick(t){try{const e=await i.A.get(`/api/admin/users/${t.id}/`,{headers:{Authorization:`Token ${localStorage.getItem("token")}`}});this.currentUser=e.data,this.userDialogVisible=!0,this.currentUser.date_joined=new Date(this.currentUser.date_joined).toLocaleString()}catch(e){this.$message.error("Ëé∑ÂèñÁî®Êà∑ËØ¶ÊÉÖÂ§±Ë¥•"),console.error("Error fetching user details:",e)}},async handleApproveItem(){try{if("pending"!==this.currentItem.status)throw new Error("Âè™ËÉΩÂÆ°Ê†∏ÂæÖÂ§ÑÁêÜÁä∂ÊÄÅÁöÑÁâ©ÂìÅ");await this.$confirm("Á°ÆÂÆöË¶ÅÈÄöËøáËØ•Áâ©ÂìÅÁöÑÂÆ°Ê†∏ÂêóÔºü","Êìç‰ΩúÁ°ÆËÆ§",{confirmButtonClass:"el-button--danger"});const t=Date.now();await this.$http.patch(`/admin/items/${this.currentItem.id}/status/`,{status:"active",admin_remark:"Â∑≤ÈÄöËøáÂÆ°Ê†∏"},{headers:{"X-Request-ID":`approve-req-${this.currentItem.id}-${Date.now()}`,"Content-Type":"application/json-patch+json"}}),this.currentItem={...this.currentItem,status:"active",admin_remark:"Â∑≤ÈÄöËøáÂÆ°Ê†∏"},this.pendingCount--,this.activeCount++,this.recentPosts=this.recentPosts.map((t=>t.id===this.currentItem.id?{...t,status:"active"}:t)),console.log(`ÂÆ°Ê†∏Êìç‰ΩúËÄóÊó∂ ${Date.now()-t}ms`),this.$message.success(`${this.currentItem.title} ÂÆ°Ê†∏ÈÄöËøá`)}catch(t){const e="cancel"===t,a=e?"Êìç‰ΩúÂ∑≤ÂèñÊ∂à":t.response?.data?.error||`ÂÆ°Ê†∏Â§±Ë¥•: ${t.message}`;!e&&console.error("ÂÆ°Ê†∏ÈîôËØØËØ¶ÊÉÖ:",{error:t.response?.data,item:this.currentItem}),this.$message[e?"info":"error"](a)}}},watch:{itemDialogVisible(t){t?setTimeout((()=>{this.initDetailMap()}),300):this.destroyDetailMap()},currentItem:{deep:!0,handler(){this.itemDialogVisible&&this.$nextTick((()=>{this.initDetailMap()}))}}}},c=l,d=a(1656),u=(0,d.A)(c,r,s,!1,null,"d8206af2",null),p=u.exports},7566:function(t,e,a){var r=a(6840),s=a(9504),i=a(655),n=a(2812),o=URLSearchParams,l=o.prototype,c=s(l.getAll),d=s(l.has),u=new o("a=1");!u.has("a",2)&&u.has("a",void 0)||r(l,"has",(function(t){var e=arguments.length,a=e<2?void 0:arguments[1];if(e&&void 0===a)return d(this,t);var r=c(this,t);n(e,1);var s=i(a),o=0;while(o<r.length)if(r[o++]===s)return!0;return!1}),{enumerable:!0,unsafe:!0})},7588:function(t,e,a){var r=a(6518),s=a(2652),i=a(9306),n=a(8551),o=a(1767);r({target:"Iterator",proto:!0,real:!0},{forEach:function(t){n(this),i(t);var e=o(this),a=0;s(e,(function(e){t(e,a++)}),{IS_RECORD:!0})}})},7799:function(t,e,a){t.exports=a.p+"img/touxiang.bf860c0f.jpg"},8721:function(t,e,a){var r=a(3724),s=a(9504),i=a(2106),n=URLSearchParams.prototype,o=s(n.forEach);r&&!("size"in n)&&i(n,"size",{get:function(){var t=0;return o(this,(function(){t++})),t},configurable:!0,enumerable:!0})},9462:function(t,e,a){var r=a(9565),s=a(2360),i=a(6699),n=a(6279),o=a(8227),l=a(1181),c=a(5966),d=a(7657).IteratorPrototype,u=a(2529),p=a(9539),m=o("toStringTag"),h="IteratorHelper",g="WrapForValidIterator",v=l.set,f=function(t){var e=l.getterFor(t?g:h);return n(s(d),{next:function(){var a=e(this);if(t)return a.nextHandler();if(a.done)return u(void 0,!0);try{var r=a.nextHandler();return a.returnHandlerResult?r:u(r,a.done)}catch(s){throw a.done=!0,s}},return:function(){var a=e(this),s=a.iterator;if(a.done=!0,t){var i=c(s,"return");return i?r(i,s):u(void 0,!0)}if(a.inner)try{p(a.inner.iterator,"normal")}catch(n){return p(s,"throw",n)}return s&&p(s,"normal"),u(void 0,!0)}})},b=f(!0),_=f(!1);i(_,m,"Iterator Helper"),t.exports=function(t,e,a){var r=function(r,s){s?(s.iterator=r.iterator,s.next=r.next):s=r,s.type=e?g:h,s.returnHandlerResult=!!a,s.nextHandler=t,s.counter=0,s.done=!1,v(this,s)};return r.prototype=e?b:_,r}}}]);
//# sourceMappingURL=22.e0837bfb.chunk.js.map