"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[560],{6560:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"lost-item-hall"},[e("h1",[t._v("ğŸ” å¤±ç‰©å¤§å…")]),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.lostItems,"header-cell-style":{background:"#f8f9fa"}},scopedSlots:t._u([{key:"empty",fn:function(){return[e("div",{staticClass:"empty-state"},[e("i",{staticClass:"el-icon-document-remove"}),e("span",[t._v("å½“å‰æ²¡æœ‰å¯æ˜¾ç¤ºçš„å¤±ç‰©ä¿¡æ¯")])])]},proxy:!0}])},[e("el-table-column",{attrs:{prop:"title",label:"ç‰©å“åç§°","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("span",{staticClass:"text-ellipsis"},[t._v(t._s(a.title))])]}}])}),e("el-table-column",{attrs:{label:"ç±»å‹",width:"100"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(" "+t._s(t.getItemTypeLabel(e.item_type))+" ")]}}])}),e("el-table-column",{attrs:{prop:"category",label:"åˆ†ç±»",width:"120"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("el-tag",{attrs:{effect:"plain"}},[t._v(t._s(a.category_name))])]}}])}),e("el-table-column",{attrs:{label:"ä¸¢å¤±æ—¶é—´",width:"150"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(" "+t._s(t.formatTime(e.lost_time))+" ")]}}])}),e("el-table-column",{attrs:{label:"ä¸¢å¤±åœ°ç‚¹",width:"200"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(" "+t._s(e.location)+" ")]}}])}),e("el-table-column",{attrs:{label:"çŠ¶æ€",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("el-tag",{staticClass:"status-tag",attrs:{type:t.statusTypeMap[a.status],effect:"light"}},[t._v(" "+t._s(a.status)+" ")])]}}])}),e("el-table-column",{attrs:{label:"æ“ä½œ",width:"100"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.viewDetails(a)}}},[t._v("æŸ¥çœ‹è¯¦æƒ…")])]}}])})],1),e("el-dialog",{attrs:{title:"ğŸ” ç‰©å“è¯¦æƒ…",visible:t.detailDialogVisible,width:"800px","custom-class":"item-detail-dialog"},on:{"update:visible":function(e){t.detailDialogVisible=e}}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:8}},[e("el-carousel",{attrs:{interval:5e3,height:"300px",arrow:"always"}},t._l(t.currentItem.images,(function(t,a){return e("el-carousel-item",{key:a},[e("el-image",{staticClass:"detail-image",attrs:{src:t,fit:"cover"}},[e("div",{staticClass:"image-error",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])])],1)})),1)],1),e("el-col",{attrs:{span:16}},[e("el-descriptions",{attrs:{column:2,border:"","label-class-name":"detail-label"}},[e("el-descriptions-item",{attrs:{label:"ç‰©å“åç§°"}},[t._v(t._s(t.currentItem.title))]),e("el-descriptions-item",{attrs:{label:"ç‰©å“åˆ†ç±»"}},[t._v(" "+t._s(t.currentItem.category_name)+" ")]),e("el-descriptions-item",{attrs:{label:"æäº¤äºº"}},["admin"===t.currentItem.user?.role?e("el-tooltip",{attrs:{content:"ç®¡ç†å‘˜è´¦å·"}},[e("i",{staticClass:"el-icon-s-custom"})]):t._e(),t._v(" "+t._s(t.currentItem.user?.real_name||"åŒ¿åç”¨æˆ·")+" "),t.currentItem.user?e("span",{staticClass:"user-role-tag"},[t._v(" ("+t._s(t.roleMap[t.currentItem.user.role])+") ")]):t._e()],1),e("el-descriptions-item",{attrs:{label:"ä¸¢å¤±æ—¶é—´"}},[t._v(" "+t._s(t.formatTime(t.currentItem.lost_time))+" ")]),e("el-descriptions-item",{attrs:{label:"ä¸¢å¤±åœ°ç‚¹"}},[t._v(" "+t._s(t.currentItem.location)+" "),t.currentItem.location_lat&&t.currentItem.location_lng?e("div",{staticClass:"detail-map-container",attrs:{id:"detail-map-"+t.currentItem.id}}):t._e()]),e("el-descriptions-item",{attrs:{label:"å‘å¸ƒç±»å‹"}},[t._v(" "+t._s("lost"===t.currentItem.item_type?"å¤±ç‰©ç™»è®°":"æ‹›é¢†ç™»è®°")+" ")]),e("el-descriptions-item",{attrs:{label:"å½“å‰çŠ¶æ€"}},[e("el-tag",{attrs:{type:t.statusTypeMap[t.currentItem.status],size:"medium"}},[t._v(" "+t._s(t.statusTextMap[t.currentItem.status])+" ")])],1),e("el-descriptions-item",{attrs:{label:"ç™»è®°æ—¶é—´"}},[t._v(" "+t._s(t.formatTime(t.currentItem.created_at))+" ")]),e("el-descriptions-item",{attrs:{label:"è¯¦ç»†æè¿°",span:2}},[e("pre",{staticClass:"description-pre"},[t._v(t._s(t.currentItem.description))])])],1)],1)],1),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.detailDialogVisible=!1}}},[t._v("å…³é—­")])],1)],1)],1)},i=[],l=a(4335),r=a(4353),n=a.n(r),o={data(){return{lostItems:[],loading:!1,detailDialogVisible:!1,currentItem:{},statusTypeMap:{pending:"warning",active:"primary",completed:"success",expired:"info"},statusTextMap:{pending:"å¾…å®¡æ ¸",active:"è¿›è¡Œä¸­",completed:"å·²å®Œæˆ",expired:"å·²è¿‡æœŸ"}}},methods:{getItemTypeLabel(t){return"lost"===t?"å¤±ç‰©ç™»è®°":"æ‹›é¢†ç™»è®°"},formatTime(t){return n()(t).format("YYYY-MM-DD HH:mm:ss")},async fetchLostItems(){this.loading=!0;try{const t=await l.A.get("/api/public/lost-items/");this.lostItems=t.data}catch(t){console.error("è·å–å¤±ç‰©ä¿¡æ¯å¤±è´¥",t)}finally{this.loading=!1}},viewDetails(t){this.currentItem=t,this.detailDialogVisible=!0},initDetailMap(){if(!window.AMap)return void this.$message.warning("åœ°å›¾èµ„æºæ­£åœ¨åŠ è½½ï¼Œè¯·ç¨å€™");const t=parseFloat(this.currentItem.location_lng),e=parseFloat(this.currentItem.location_lat);if(isNaN(t)||isNaN(e))return;this.destroyDetailMap();const a=`detail-map-${this.currentItem.id}`,s=document.getElementById(a);if(!s)return;this.detailMap=new AMap.Map(a,{zoom:17,center:[t,e],resizeEnable:!0});const i=new AMap.Scale,l=new AMap.ToolBar({position:{bottom:"20px",right:"20px"}});i.addTo(this.detailMap),l.addTo(this.detailMap),new AMap.Marker({position:[t,e],content:'<div class="location-pin">ğŸ“</div>',map:this.detailMap})},destroyDetailMap(){if(this.detailMap){try{this.detailMap.destroy()}catch(t){console.warn("åœ°å›¾é”€æ¯è¿‡ç¨‹ä¸­å‡ºç°è­¦å‘Š:",t.message)}this.detailMap=null}}},mounted(){if(this.fetchLostItems(),!window.AMap){const t="db70318a1cf1f196b2746f10cb9df826",e=["AMap.Scale","AMap.ToolBar"].join(","),a=document.createElement("script");a.src=`https://webapi.amap.com/maps?v=2.0&key=${t}&plugin=${e}`,a.onerror=()=>{console.error("é«˜å¾·åœ°å›¾SDKåŠ è½½å¤±è´¥")},document.head.appendChild(a)}},computed:{roleMap(){return{admin:"ç®¡ç†å‘˜",teacher:"æ•™èŒå·¥",student:"å­¦ç”Ÿ"}}},watch:{detailDialogVisible(t){t?this.$nextTick((()=>{this.currentItem.location_lat&&this.currentItem.location_lng&&this.initDetailMap()})):this.destroyDetailMap()}}},c=o,u=a(1656),d=(0,u.A)(c,s,i,!1,null,"4f44ef3e",null),p=d.exports}}]);
//# sourceMappingURL=560.2f3eea7d.chunk.js.map