{"version":3,"file":"js/724.9774c34d.chunk.js","mappings":"4JAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,sBAAsB,CAACF,EAAG,KAAK,CAACF,EAAIK,GAAG,UAAUH,EAAG,UAAU,CAACI,IAAI,UAAUC,MAAM,CAAC,MAAQP,EAAIQ,KAAK,cAAc,QAAQ,MAAQR,EAAIS,QAAQ,CAACP,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,KAAK,KAAO,UAAU,CAACL,EAAG,WAAW,CAACQ,MAAM,CAACC,MAAOX,EAAIQ,KAAKI,MAAOC,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIQ,KAAM,QAASM,EAAI,EAAEE,WAAW,iBAAiB,GAAGd,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,OAAO,KAAO,gBAAgB,CAACL,EAAG,WAAW,CAACK,MAAM,CAAC,KAAO,YAAYG,MAAM,CAACC,MAAOX,EAAIQ,KAAKS,YAAaJ,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIQ,KAAM,cAAeM,EAAI,EAAEE,WAAW,uBAAuB,GAAGd,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,OAAO,KAAO,cAAc,CAACL,EAAG,iBAAiB,CAACK,MAAM,CAAC,KAAO,WAAW,YAAc,UAAUG,MAAM,CAACC,MAAOX,EAAIQ,KAAKU,UAAWL,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIQ,KAAM,YAAaM,EAAI,EAAEE,WAAW,qBAAqB,GAAGd,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,KAAK,KAAO,aAAa,CAACL,EAAG,WAAW,CAACQ,MAAM,CAACC,MAAOX,EAAIQ,KAAKW,SAAUN,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIQ,KAAM,WAAYM,EAAI,EAAEE,WAAW,oBAAoB,GAAGd,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,OAAO,KAAO,aAAa,CAACL,EAAG,YAAY,CAACK,MAAM,CAAC,YAAc,WAAWG,MAAM,CAACC,MAAOX,EAAIQ,KAAKY,SAAUP,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIQ,KAAM,WAAYM,EAAI,EAAEE,WAAW,kBAAkBhB,EAAIqB,GAAIrB,EAAIsB,YAAY,SAASF,GAAU,OAAOlB,EAAG,YAAY,CAACqB,IAAIH,EAASI,GAAGjB,MAAM,CAAC,MAAQa,EAASK,KAAK,MAAQL,EAASI,KAAK,IAAG,IAAI,GAAGtB,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,OAAO,KAAO,YAAY,CAACL,EAAG,WAAW,CAACQ,MAAM,CAACC,MAAOX,EAAIQ,KAAKkB,QAASb,SAAS,SAAUC,GAAMd,EAAIe,KAAKf,EAAIQ,KAAM,UAAWM,EAAI,EAAEE,WAAW,mBAAmB,GAAGd,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,SAAS,CAACL,EAAG,YAAY,CAACK,MAAM,CAAC,OAAS,eAAe,UAAW,EAAK,aAAaP,EAAI2B,oBAAoB,gBAAgB3B,EAAI4B,aAAa,YAAY5B,EAAI6B,SAAS,SAAW7B,EAAI8B,eAAe,CAAC5B,EAAG,YAAY,CAACK,MAAM,CAAC,KAAO,QAAQ,KAAO,YAAY,CAACP,EAAIK,GAAG,WAAW,IAAI,GAAGH,EAAG,eAAe,CAACA,EAAG,YAAY,CAACK,MAAM,CAAC,KAAO,UAAU,QAAUP,EAAI8B,cAAcC,GAAG,CAAC,MAAQ/B,EAAIgC,aAAa,CAAChC,EAAIK,GAAG,WAAW,IAAI,IAAI,EAChoE,EACI4B,EAAkB,G,oBCuDtB,GACAC,IAAAA,GACA,OACA1B,KAAA,CACAI,MAAA,GACAK,YAAA,GACAC,UAAA,KACAC,SAAA,GACAC,SAAA,KACAM,QAAA,GACAS,OAAA,IAEAb,WAAA,GACAO,SAAA,GACApB,MAAA,CACAG,MAAA,CACA,CAAAwB,UAAA,EAAAC,QAAA,QAAAC,QAAA,SAEArB,YAAA,CACA,CAAAmB,UAAA,EAAAC,QAAA,UAAAC,QAAA,SAEApB,UAAA,CACA,CAAAkB,UAAA,EAAAC,QAAA,UAAAC,QAAA,WAEAnB,SAAA,CACA,CAAAiB,UAAA,EAAAC,QAAA,QAAAC,QAAA,SAEAlB,SAAA,CACA,CAAAgB,UAAA,EAAAC,QAAA,UAAAC,QAAA,WAEAZ,QAAA,CACA,CAAAU,UAAA,EAAAC,QAAA,UAAAC,QAAA,UAGAR,cAAA,EAEA,EACAS,OAAAA,GACA,KAAAC,iBACA,EACAC,QAAA,CACA,qBAAAD,GACA,IACA,MAAAE,QAAAC,EAAAA,EAAAC,IAAA,oBACA,KAAAtB,WAAAoB,EAAAR,IACA,OAAAW,GACAC,QAAAD,MAAA,YAAAA,GACA,KAAAE,SAAAF,MAAA,kBACA,CACA,EACA,gBAAAb,GACA,IACA,MAAAU,QAAAC,EAAAA,EAAAK,KAAA,wBAAAxC,MACAyC,EAAAP,EAAAR,KAAAV,GAEA,QAAA0B,EAAA,EAAAA,EAAA,KAAA1C,KAAA2B,OAAAgB,OAAAD,IAAA,CACA,MAAAE,EAAA,IAAAC,SACAD,EAAAE,OAAA,aAAA9C,KAAA2B,OAAAe,IACAE,EAAAE,OAAA,UAAAL,SACAN,EAAAA,EAAAK,KAAA,eAAAI,EAAA,CACAG,QAAA,CACA,uCAGA,CACA,KAAAR,SAAAS,QAAA,mBACA,KAAAC,QAAAC,KAAA,mBACA,OAAAb,GACA,KAAAE,SAAAF,MAAA,gBACA,CACA,EACAlB,mBAAAA,CAAAe,GACA,KAAAlC,KAAA2B,OAAAuB,KAAAhB,EAAAiB,IACA,EACA/B,YAAAA,CAAAgC,GACA,MAAAC,EAAA,eAAAD,EAAAE,MAAA,cAAAF,EAAAE,KACAD,GACA,KAAAd,SAAAF,MAAA,uBAEA,MAAAkB,EAAAH,EAAAI,KAAA,YAIA,OAHAD,GACA,KAAAhB,SAAAF,MAAA,iBAEAgB,GAAAE,CACA,IC7I+P,I,UCO3PE,GAAY,OACd,EACAlE,EACAkC,GACA,EACA,KACA,WACA,MAIF,EAAegC,EAAiB,O","sources":["webpack://frontend/./src/views/LostItemRegister.vue","webpack://frontend/src/views/LostItemRegister.vue","webpack://frontend/./src/views/LostItemRegister.vue?7e42","webpack://frontend/./src/views/LostItemRegister.vue?2b69"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"lost-item-register\"},[_c('h1',[_vm._v(\"失物登记\")]),_c('el-form',{ref:\"formRef\",attrs:{\"model\":_vm.form,\"label-width\":\"120px\",\"rules\":_vm.rules}},[_c('el-form-item',{attrs:{\"label\":\"标题\",\"prop\":\"title\"}},[_c('el-input',{model:{value:(_vm.form.title),callback:function ($$v) {_vm.$set(_vm.form, \"title\", $$v)},expression:\"form.title\"}})],1),_c('el-form-item',{attrs:{\"label\":\"详细描述\",\"prop\":\"description\"}},[_c('el-input',{attrs:{\"type\":\"textarea\"},model:{value:(_vm.form.description),callback:function ($$v) {_vm.$set(_vm.form, \"description\", $$v)},expression:\"form.description\"}})],1),_c('el-form-item',{attrs:{\"label\":\"丢失时间\",\"prop\":\"lost_time\"}},[_c('el-date-picker',{attrs:{\"type\":\"datetime\",\"placeholder\":\"选择丢失时间\"},model:{value:(_vm.form.lost_time),callback:function ($$v) {_vm.$set(_vm.form, \"lost_time\", $$v)},expression:\"form.lost_time\"}})],1),_c('el-form-item',{attrs:{\"label\":\"地点\",\"prop\":\"location\"}},[_c('el-input',{model:{value:(_vm.form.location),callback:function ($$v) {_vm.$set(_vm.form, \"location\", $$v)},expression:\"form.location\"}})],1),_c('el-form-item',{attrs:{\"label\":\"物品分类\",\"prop\":\"category\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择物品分类\"},model:{value:(_vm.form.category),callback:function ($$v) {_vm.$set(_vm.form, \"category\", $$v)},expression:\"form.category\"}},_vm._l((_vm.categories),function(category){return _c('el-option',{key:category.id,attrs:{\"label\":category.name,\"value\":category.id}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"联系方式\",\"prop\":\"contact\"}},[_c('el-input',{model:{value:(_vm.form.contact),callback:function ($$v) {_vm.$set(_vm.form, \"contact\", $$v)},expression:\"form.contact\"}})],1),_c('el-form-item',{attrs:{\"label\":\"物品图片\"}},[_c('el-upload',{attrs:{\"action\":\"/api/upload/\",\"multiple\":true,\"on-success\":_vm.handleUploadSuccess,\"before-upload\":_vm.beforeUpload,\"file-list\":_vm.fileList,\"disabled\":_vm.isSubmitting}},[_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"}},[_vm._v(\"点击上传\")])],1)],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.isSubmitting},on:{\"click\":_vm.submitForm}},[_vm._v(\" 提交 \")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"lost-item-register\">\r\n    <h1>失物登记</h1>\r\n    <el-form :model=\"form\" ref=\"formRef\" label-width=\"120px\" :rules=\"rules\">\r\n      <el-form-item label=\"标题\" prop=\"title\">\r\n        <el-input v-model=\"form.title\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"详细描述\" prop=\"description\">\r\n        <el-input type=\"textarea\" v-model=\"form.description\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"丢失时间\" prop=\"lost_time\">\r\n        <el-date-picker\r\n            v-model=\"form.lost_time\"\r\n            type=\"datetime\"\r\n            placeholder=\"选择丢失时间\"\r\n        ></el-date-picker>\r\n      </el-form-item>\r\n      <el-form-item label=\"地点\" prop=\"location\">\r\n        <el-input v-model=\"form.location\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"物品分类\" prop=\"category\">\r\n        <el-select v-model=\"form.category\" placeholder=\"请选择物品分类\">\r\n          <el-option\r\n              v-for=\"category in categories\"\r\n              :key=\"category.id\"\r\n              :label=\"category.name\"\r\n              :value=\"category.id\"\r\n          ></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"联系方式\" prop=\"contact\">\r\n        <el-input v-model=\"form.contact\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"物品图片\">\r\n        <el-upload\r\n            action=\"/api/upload/\"\r\n            :multiple=\"true\"\r\n            :on-success=\"handleUploadSuccess\"\r\n            :before-upload=\"beforeUpload\"\r\n            :file-list=\"fileList\"\r\n            :disabled=\"isSubmitting\"\r\n        >\r\n          <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n        </el-upload>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"submitForm\" :loading=\"isSubmitting\">\r\n          提交\r\n        </el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      form: {\r\n        title: '',\r\n        description: '',\r\n        lost_time: null,\r\n        location: '',\r\n        category: null,\r\n        contact: '',\r\n        images: []\r\n      },\r\n      categories: [],\r\n      fileList: [],\r\n      rules: {\r\n        title: [\r\n          {required: true, message: '请输入标题', trigger: 'blur'}\r\n        ],\r\n        description: [\r\n          {required: true, message: '请输入详细描述', trigger: 'blur'}\r\n        ],\r\n        lost_time: [\r\n          {required: true, message: '请选择丢失时间', trigger: 'change'}\r\n        ],\r\n        location: [\r\n          {required: true, message: '请输入地点', trigger: 'blur'}\r\n        ],\r\n        category: [\r\n          {required: true, message: '请选择物品分类', trigger: 'change'}\r\n        ],\r\n        contact: [\r\n          {required: true, message: '请输入联系方式', trigger: 'blur'}\r\n        ]\r\n      },\r\n      isSubmitting: false\r\n    }\r\n  },\r\n  mounted() {\r\n    this.fetchCategories()\r\n  },\r\n  methods: {\r\n    async fetchCategories() {\r\n      try {\r\n        const response = await axios.get('/api/categories/')\r\n        this.categories = response.data\r\n      } catch (error) {\r\n        console.error('获取物品分类失败:', error)\r\n        this.$message.error('获取物品分类失败，请稍后重试。')\r\n      }\r\n    },\r\n    async submitForm() {\r\n      try {\r\n        const response = await axios.post('/api/items/lost/', this.form);\r\n        const itemId = response.data.id;\r\n        // 上传图片并关联到失物信息\r\n        for (let i = 0; i < this.form.images.length; i++) {\r\n          const formData = new FormData();\r\n          formData.append('image', this.form.images[i]);\r\n          formData.append('item_id', itemId);\r\n          await axios.post('/api/upload/', formData, {\r\n            headers: {\r\n              'Content-Type': 'multipart/form-data'\r\n            }\r\n          });\r\n        }\r\n        this.$message.success('失物信息已成功登记');\r\n        await this.$router.push('/items/lost/list');\r\n      } catch (error) {\r\n        this.$message.error('提交失败，请检查输入信息。');\r\n      }\r\n    },\r\n    handleUploadSuccess(response) {\r\n      this.form.images.push(response.url)\r\n    },\r\n    beforeUpload(file) {\r\n      const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png'\r\n      if (!isJpgOrPng) {\r\n        this.$message.error('只能上传 JPG/PNG 格式的图片！')\r\n      }\r\n      const isLt2M = file.size / 1024 / 1024 < 2\r\n      if (!isLt2M) {\r\n        this.$message.error('图片大小不能超过 2MB！')\r\n      }\r\n      return isJpgOrPng && isLt2M\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./LostItemRegister.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./LostItemRegister.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./LostItemRegister.vue?vue&type=template&id=09c14f66&scoped=true\"\nimport script from \"./LostItemRegister.vue?vue&type=script&lang=js\"\nexport * from \"./LostItemRegister.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"09c14f66\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","_v","ref","attrs","form","rules","model","value","title","callback","$$v","$set","expression","description","lost_time","location","category","_l","categories","key","id","name","contact","handleUploadSuccess","beforeUpload","fileList","isSubmitting","on","submitForm","staticRenderFns","data","images","required","message","trigger","mounted","fetchCategories","methods","response","axios","get","error","console","$message","post","itemId","i","length","formData","FormData","append","headers","success","$router","push","url","file","isJpgOrPng","type","isLt2M","size","component"],"sourceRoot":""}